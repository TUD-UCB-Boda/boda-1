#ifdef GLSL
layout (local_size_x = __wg_sz__, local_size_y = 1, local_size_z = 1) in;
layout(set = 0, binding = 0) readonly buffer out_buf_t{
  float out_buf[];
};
layout(set = 0, binding = 1) readonly buffer biases_t{
  float biases[];
};
layout(set = 0, binding = 2) buffer out_buf_ref_t{
  float out_buf_ref[];
};
void main()
#else
CUCL_GLOBAL_KERNEL void %(rtc_func_name)( GASQ float const * const out_buf, // CUCL IN M:N
		   			  GASQ float const * const biases, // CUCL IN out_chan
					  GASQ float * const out_buf_ref) // CUCL OUT img:chan:y:x
#endif					  
{
  // CUCL IX GLOB_ID_1D out_buf_ref
    if( GLOB_ID_1D >= %(out_buf_ref_dims_prod) ) { return; }
  uint32_t out_buf_ix = %(out_buf_M_stride)*%(GLOB_ID_1D_chan) + %(GLOB_ID_1D_img)*%(out_buf_ref_chan_stride) +
  	   	       	%(GLOB_ID_1D_y)*%(out_buf_ref_y_stride)+%(GLOB_ID_1D_x);
  // TODO: check if relu needed
  float val = out_buf[out_buf_ix] + biases[%(GLOB_ID_1D_chan)];
  out_buf_ref[GLOB_ID_1D] = val > 0 ? val : 0;

}