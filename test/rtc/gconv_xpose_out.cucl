CUCL_GLOBAL_KERNEL void %(rtc_func_name)( GASQ float const * const out, // CUCL IN M:N
                      GASQ float * const out_ref) // CUCL OUT img:chan:y:x
{
  // CUCL IX GLOB_ID_1D out_ref
  uint32_t out_ix = %(out_M_stride)*%(GLOB_ID_1D_chan) + %(GLOB_ID_1D_img)*%(out_ref_chan_stride) +
                        %(GLOB_ID_1D_y)*%(out_ref_y_stride)+%(GLOB_ID_1D_x);
  out_ref[GLOB_ID_1D] = out[out_ix];

}
